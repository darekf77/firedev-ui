<firedev-progress-bar></firedev-progress-bar>
<firedev-notifications></firedev-notifications>
<button class="admin-show-button"
        showDesktop
        *ngIf="!admin.draggablePopupMode"
        (click)="toogle()"> Admin </button>

<ng-template #content>
  <ng-content>
  </ng-content>
</ng-template>


<ng-template #adminTabs>
  <div class="firedev-header-admin-wrapper">
    <columns-container class="firedev-header-admin"
                       [ngClass]="{ 'draggable-column' : (admin.draggablePopupMode) }">
      <column width="200"
              class="logo-header">
        <img *ngIf="openedOnce"
             src="src/assets/shared/logo-header-admin-mode.png">
      </column>

      <column grow>
        <!-- <span>Super Admin Mode</span> -->
      </column>


      <column width="40"
              *ngIf="!admin.draggablePopupModeFullScreen && !admin.draggablePopupMode">
        <button mat-icon-button
                class="admin-close-button">
          <mat-icon *ngIf="admin.draggablePopupMode"
                    (click)="admin.draggablePopupMode =false;opened = false;wasOpenDraggablePopup = true;">close
          </mat-icon>
          <mat-icon *ngIf="!admin.draggablePopupMode"
                    (click)="toogle();">close</mat-icon>
        </button>
      </column>

      <!-- <column width="40"
              *ngIf="admin.draggablePopupMode">
        <button mat-icon-button
                class="admin-close-button">
          <mat-icon *ngIf="!admin.draggablePopupModeFullScreen"
                    (click)="toogleFullScreen();">fullscreen</mat-icon>
          <mat-icon *ngIf="admin.draggablePopupModeFullScreen"
                    (click)="toogleFullScreen();">close_fullscreen</mat-icon>
        </button>
      </column> -->

      <column width="40"
              *ngIf="!admin.draggablePopupModeFullScreen">
        <button mat-icon-button
                class="admin-close-button">
          <mat-icon *ngIf="!admin.draggablePopupMode"
                    (click)="admin.draggablePopupMode = true">launch</mat-icon>
          <mat-icon *ngIf="admin.draggablePopupMode"
                    style="transform: rotate(180deg);"
                    (click)="admin.draggablePopupMode = false;resetDrag();">login</mat-icon>
        </button>
      </column>


    </columns-container>
  </div>

  <columns-container [ngClass]="{ 'draggable-column' : (admin.draggablePopupMode) }">
    <column grow>
      <mat-tab-group dynamicHeight
                     (wheel)="scrollTabs($event)"
                     #tabGroup
                     [selectedIndex]="selectedIndex"
                     (selectedIndexChange)="selectedIndex = $event">
        <mat-tab label="DB/Cache">
          <section>
            <mat-card>
              <mat-card-header>
                <mat-card-subtitle>WEBSQL MODE</mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>
                <mat-checkbox [disabled]="!isWebSQLMode"
                              [ngModel]="admin.keepWebsqlDbDataAfterReload"
                              (change)="admin.setKeepWebsqlDbDataAfterReload($event.checked)">
                  Don't remove data when reloading
                </mat-checkbox>
              </mat-card-content>
            </mat-card>
            <!-- <button mat-raised-button
                    [disabled]="!isWebSQLMode"> [TODO] Reinit db with default values and reload </button> <br>
            <button mat-raised-button>[TODO] Start database export </button> <br>
            <button mat-raised-button>[TODO] Import whole database </button><br> -->
          </section>
        </mat-tab>

        <mat-tab label="Files">
          <section>
            <mat-checkbox [ngModel]="admin.filesEditMode"
                          (change)="admin.setEditMode($event.checked)">Edit mode</mat-checkbox>
          </section>
          <!-- admin.filesEditMode: {{ admin.filesEditMode }} -->
          <firedev-admin-edit-mode *ngIf="admin.filesEditMode">
          </firedev-admin-edit-mode>
          <br>
          <hr *ngIf="admin.filesEditMode" >
          <!-- <section>
            <button mat-raised-button>[TODO] Clear Files from browser cache </button> <br>
            <button mat-raised-button>[TODO] Start files export (as zip) </button> <br>
            <button mat-raised-button>[TODO] Import whole database (from zip) </button><br>
          </section> -->
        </mat-tab>
        <!-- <mat-tab label="Portal">
          <section>
            <mat-checkbox>[TODO] Maintenance Mode for whole portal</mat-checkbox>

            <mat-expansion-panel>

              <mat-expansion-panel-header>
                [TODO] Active User: 80432
              </mat-expansion-panel-header>
              <section>
                <button mat-raised-button>[TODO] Send notification to users </button><br>
                <button mat-raised-button>[TODO] Send email to users </button><br>
              </section>
            </mat-expansion-panel>
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                [TODO] Enable features
              </mat-expansion-panel-header>
              <mat-checkbox>[TODO] AB testing</mat-checkbox> <br>
              <mat-checkbox>
                [TODO] Newsletter email question popup
              </mat-checkbox> <br>
              <mat-checkbox>
                [TODO] Promotion popup
              </mat-checkbox> <br>
            </mat-expansion-panel>
          </section>
        </mat-tab>
        <mat-tab label="User">
          Welcome in user managements
        </mat-tab>
        <mat-tab label="Translations">
          Welcome in user managements
        </mat-tab> -->

      </mat-tab-group>
    </column>

  </columns-container>
</ng-template>

<div class="draggable-popup-mode-window"
     *ngIf="admin.draggablePopupMode && !admin.draggablePopupModeFullScreen"
     cdkDrag
     [cdkDragFreeDragPosition]="dragPosition"
     (cdkDragEnded)="moved($event)">
  <ng-scrollbar>
    <ng-container [ngTemplateOutlet]="adminTabs"></ng-container>
  </ng-scrollbar>
</div>

<div class="draggable-popup-mode-window-full"
     *ngIf="admin.draggablePopupModeFullScreen"
     cdkDrag
     [cdkDragFreeDragPosition]="dragPositionZero">
  <ng-container [ngTemplateOutlet]="adminTabs"></ng-container>
</div>


<ng-container *ngIf="admin.draggablePopupMode || admin.draggablePopupModeFullScreen"
              [ngTemplateOutlet]="content"></ng-container>

<mat-drawer-container *ngIf="!admin.draggablePopupMode"
                      class="example-container"
                      [style.height.px]="height"
                      style="background-color: transparent;"
                      (backdropClick)="opened = false"
                      [hasBackdrop]="false">
  <mat-drawer #drawer
              style="width: 580px;"
              [opened]="opened"
              showDesktop
              [mode]="'side'">

    <ng-container [ngTemplateOutlet]="adminTabs"></ng-container>

  </mat-drawer>
  <mat-drawer-content>
    <ng-container *ngIf="!admin.draggablePopupMode"
                  [ngTemplateOutlet]="content"></ng-container>

  </mat-drawer-content>
</mat-drawer-container>
